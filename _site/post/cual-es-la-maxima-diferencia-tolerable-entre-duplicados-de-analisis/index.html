<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2017-08-28">

<title>Analytical - ¿Cuál es la máxima diferencia tolerable entre duplicados de análisis?</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
<link rel="stylesheet" href="../../custom.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title"><strong>Analytical</strong></span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../cursos.html" rel="" target="">
 <span class="menu-text">Cursos</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html" rel="" target="">
 <span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../libro.html" rel="" target="">
 <span class="menu-text">Libro</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">Quénes somos</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto tools-wide">
    <a href="https://github.com/analytical/website_analytical" rel="" title="Código fuente" class="quarto-navigation-tool px-1" aria-label="Código fuente"><i class="bi bi-github"></i></a>
    <a href="https://www.linkedin.com/in/cjgomezs/" rel="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-linkedin"></i></a>
    <a href="mailto:cvgomez@gmail.com" rel="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-envelope"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#límite-de-repetibilidad-r-iso-5725" id="toc-límite-de-repetibilidad-r-iso-5725" class="nav-link active" data-scroll-target="#límite-de-repetibilidad-r-iso-5725">Límite de repetibilidad <span class="math inline">\(r\)</span> ISO 5725</a></li>
  <li><a href="#cómo-obtenemos-la-precisión-de-repetibilidad-s_r" id="toc-cómo-obtenemos-la-precisión-de-repetibilidad-s_r" class="nav-link" data-scroll-target="#cómo-obtenemos-la-precisión-de-repetibilidad-s_r">¿Cómo obtenemos la precisión de repetibilidad <span class="math inline">\(s_{r}\)</span>?</a></li>
  <li><a href="#método-de-estimación-en-base-a-datos-históricos-de-duplicados" id="toc-método-de-estimación-en-base-a-datos-históricos-de-duplicados" class="nav-link" data-scroll-target="#método-de-estimación-en-base-a-datos-históricos-de-duplicados">Método de estimación en base a datos históricos de duplicados</a></li>
  <li><a href="#estimación-mediante-estudios-de-precisión-siguiendo-las-directrices-de-la-guía-iso-5725" id="toc-estimación-mediante-estudios-de-precisión-siguiendo-las-directrices-de-la-guía-iso-5725" class="nav-link" data-scroll-target="#estimación-mediante-estudios-de-precisión-siguiendo-las-directrices-de-la-guía-iso-5725">Estimación mediante estudios de precisión siguiendo las directrices de la guía ISO 5725</a></li>
  <li><a href="#bonus-track-breve-historia-del-factor-2.8" id="toc-bonus-track-breve-historia-del-factor-2.8" class="nav-link" data-scroll-target="#bonus-track-breve-historia-del-factor-2.8"><em>Bonus track</em> : Breve historia del factor 2.8</a></li>
  <li><a href="#bibliografía" id="toc-bibliografía" class="nav-link" data-scroll-target="#bibliografía">Bibliografía</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">¿Cuál es la máxima diferencia tolerable entre duplicados de análisis?</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 28, 2017</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p>Un día cualquiera en un laboratorio que aún no establece criterios de aceptación de precisión:</p>
<ul>
<li>Duplicado 1 = 25.56 % Cu</li>
<li>Duplicado 2 = 25.66 % Cu</li>
<li>Diferencia = 0.10 % Cu</li>
</ul>
<p>La diferencia observada ¿es aceptable para el laboratorio?</p>
<p>Para responder a esta pregunta debemos considerar varias cosas:</p>
<ol type="1">
<li>¿Los duplicados fueron realizados en condiciones de repetibilidad o reproducibilidad?</li>
<li>¿Existe alguna normativa al respecto que se deba cumplir?</li>
<li>¿Cuál es la metodología analítica? No es lo mismo determinar Cu en concentrado de cobre por electrogravimetría (método primario) que por Fluorescencia de Rayos X.</li>
<li>¿Cuál es la incertidumbre del método analítico?</li>
<li>¿Existe algún acuerdo a nivel comercial sobre estas diferencias?</li>
</ol>
<p>Para abordar este problema tendremos que hace la suposición que los duplicados fueron obtenidos en condiciones de repetibilidad, es decir: mismo analista, mismo día, mismo instrumento, etc. Bajo esta premisa hay varias formas de estimar la máxima diferencia tolerable entre duplicados de análisis.</p>
<p><em><strong>Nota</strong>: En realidad, los conceptos que mostraremos a continuación son completamente análogos para estimar la máxima diferencia tolerable en condiciones de reproducibilidad. Sin embargo, dedicaremos otro post a ese tema específico.</em></p>
<p>El concepto estadístico clave para establecer la tolerancia entre duplicados es el límite de repetibilidad <span class="math inline">\(r\)</span>.</p>
<section id="límite-de-repetibilidad-r-iso-5725" class="level1">
<h1>Límite de repetibilidad <span class="math inline">\(r\)</span> ISO 5725</h1>
<p>La guía ISO 5725 define el límite de repetibilidad <span class="math inline">\(r\)</span> de la siguiente manera:</p>
<p><span class="math display">\[
r = 2.8\cdot s_{r}
\]</span> y corresponde a la máxima diferencia, en valor absoluto, que puede tolerarse entre duplicados de análisis, obtenidos bajo condiciones de repetibilidad con un 95% de confianza. Veamos:</p>
<ul>
<li><p><span class="math inline">\(s_{r}\)</span> es la desviación estándar de repetibilidad, la cual da cuenta de la dispersión de las diferencias entre duplicados. Ya explicaremos cómo calcular este parámetro.</p></li>
<li><p>El factor <strong>2.8</strong>: aquí les exijo una prueba de fe mis hermanos, me tienen que creer porque si quieren la demostración, aumentaría mucho la viscosidad de este post . A <em>grosso modo</em>, el factor 2.8 tiene que ver con el 95% de confianza, nos indica que cuando se establece la máxima diferencia tolerable, está permitido que el 5% de los duplicados estén fuera del límite <span class="math inline">\(r\)</span>, y aún el sistema analítico se encontraría bajo <em>Control Estadístico</em>.</p></li>
</ul>
</section>
<section id="cómo-obtenemos-la-precisión-de-repetibilidad-s_r" class="level1">
<h1>¿Cómo obtenemos la precisión de repetibilidad <span class="math inline">\(s_{r}\)</span>?</h1>
<p>Existen varios métodos estadísticos para abordar la estimación de la desviación estándar de repetibililidad <span class="math inline">\(s_{r}\)</span>, sin embargo, en este post nos enfocaremos en los dos más utilizados en química analítica:</p>
<ol type="1">
<li><p>Estimación basada en el registro histórico de duplicados de análisis.</p></li>
<li><p>La estimación mediante estudios de precisión siguiendo las directrices de la guía ISO 5725.</p></li>
</ol>
<p>No describiremos todos los detalles de cada uno de los diseños experimentales expuestos en estas guías, más bien, ejemplificaremos el cálculo de la desviación estándar de repetibilidad <span class="math inline">\(s_{r}\)</span>:</p>
</section>
<section id="método-de-estimación-en-base-a-datos-históricos-de-duplicados" class="level1">
<h1>Método de estimación en base a datos históricos de duplicados</h1>
<p>Obviamente necesitamos crear una base de datos con los registros de análisis de muestras en duplicados en condiciones de repetibilidad. Estas muestras pueden corresponder a muestras de clientes, materiales de referencia primarios o secundarios, muestras control, etc. Lo importante es que ambos duplicados cumplan con las condiciones de repetibilidad. La tabla @ref(tab:bdsr) es un ejemplo de una base de datos a utilizar en este método:</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Base de datos histórica de duplicados (sólo los primeros 6 datos)</caption>
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">ID</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Duplicado 1</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Duplicado 2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">QAQC-01</td>
<td style="text-align: center;">30.79</td>
<td style="text-align: center;">30.54</td>
</tr>
<tr class="even">
<td style="text-align: center;">QAQC-02</td>
<td style="text-align: center;">31.89</td>
<td style="text-align: center;">32.04</td>
</tr>
<tr class="odd">
<td style="text-align: center;">QAQC-03</td>
<td style="text-align: center;">31.28</td>
<td style="text-align: center;">31.32</td>
</tr>
<tr class="even">
<td style="text-align: center;">QAQC-04</td>
<td style="text-align: center;">31.30</td>
<td style="text-align: center;">30.89</td>
</tr>
<tr class="odd">
<td style="text-align: center;">QAQC-05</td>
<td style="text-align: center;">30.70</td>
<td style="text-align: center;">30.66</td>
</tr>
<tr class="even">
<td style="text-align: center;">QAQC-06</td>
<td style="text-align: center;">30.86</td>
<td style="text-align: center;">30.69</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Puede descargar esta base de datos desde este <a href="https://1drv.ms/x/s!AuF6FPVWruwDyb4zAv7amIDqVpCvYA?e=5oqkgc">link</a>. Y ahora la pregunta del millón: ¿Cuántas muestras en duplicado necesito? Si bien es posible obtener un cálculo “exacto” del número de muestras <span class="math inline">\(n\)</span>, esto está fuera del alcance de este post. Sin embargo, podemos decir que <span class="math inline">\(n &gt; 25\)</span> es un número inicial adecuado.</p>
<p>Una vez construida la base de datos, se puede obtener una estimación de <span class="math inline">\(s_{r}\)</span> mediante la ecuación @ref(eq:srdup):</p>
<p><span class="math display">\[\begin{equation}
  s_{r} = \sqrt{\frac{\sum_{i = 1}^{n} (x_{i1} - x_{i2})^2}{2n}}
  (\#eq:srdup)
\end{equation}\]</span></p>
<p>Esta ecuación puede ser fácilmente implementada en Excel pero en este post, como no, haremos los cálculos en lenguaje R. Pero antes, observe la figura @ref(fig:dup) la cual muestra un gráfico de dispersión entre Duplicado 1 (<span class="math inline">\(X\)</span>) y Duplicado 2 (<span class="math inline">\(Y\)</span>). En este caso el orden es irrelevante. Si ajustáramos un modelo lineal entre ambas variables ¿Qué valores de pendiente e intercepto deberíamos obtener?</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/dup-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Gráfico de dispersión entre duplicados</figcaption>
</figure>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>¡Correcto! Pendiente <span class="math inline">\(\beta_{1} = 1\)</span> e intercepto <span class="math inline">\(\beta_{0} = 0\)</span>. La línea roja representa esta recta teórica. Note también que la dispersión de los datos es constante en todo el rango de concentración, propiedad denominada <strong>Homocedasticidad</strong>.</p>
</blockquote>
<p>Esta propiedad es deseable, sin embargo, no todos los sistemas analíticos la poseen. En sí misma no es una problema, sin embargo, si la varibilidad de los duplicados aumenta con la concentración (<em>heterocedasticidad</em>) tendremos que modelar esta variabilidad en función de la concentración en forma explícita o segmentar el rango, lo cual veremos en otro post.</p>
<p>También advierta la presencia de datos alejados de la diagonal, es decir, diferencias entre duplicados grandes. ¿Qué hacemos con ellos?¿Los mantenemos o los eliminamos?</p>
<p>Si los eliminamos, y realmente reflejaran la variabilidad del método, entonces subestimaríamos la máxima diferencia tolerable entre duplicados, aumentando la frecuencia de alertas de duplicados no conformes (nos ponemos la soga al cuello solitos). Si los mantenemos, y realmente fueron <em>errores</em> puntuales de medición, sobreestimaríamos la tolerancia y la carta control sería de poca utilidad (mágicamente todos los datos caerían siempre dentro del los límites). Este tema lo abordaremos en otro post (llevo una lista).</p>
<p>Como dato “anecdótico” en las operaciones de <em>trading</em> en el mercado mundial de concentrado de cobre, la máxima diferencia tolerable entre resultados de distintos laboratorios (a.k.a exportador v/s importador) es 0,20 % Cu. Si la diferencia supera este límite, ambos negociadores se van a un arbitraje (multiplique 0,2 % Cu por la millones de toneladas que se transan en el mercado…a <span class="math inline">\(X\)</span> US/libra no es un asunto trivial).</p>
<p>Utilizando los datos históricos estimamos una desviación estándar de repetibilidad de <span class="math inline">\(s_{r} = 0.2\)</span> % Cu. Por lo tanto, el límite de repetibilidad es obtenido de la ecuación @ref(eq:limr):</p>
<p><span class="math display">\[\begin{eqnarray}
  r &amp;=&amp; 2.8\cdot s_{r} \\
  r &amp;=&amp; 2.8\cdot 0.2 \\
  r &amp;=&amp; 0.57\, \text{% Cu}
  (\#eq:limr)
\end{eqnarray}\]</span></p>
<blockquote class="blockquote">
<p><strong>Interpretación</strong>: La máxima diferencia tolerable, en valor absoluto, entre duplicados de análisis en condiciones de repetibilidad es <span class="math inline">\(r = 0.57\)</span> % Cu.</p>
</blockquote>
<p>Entonces, dados los datos iniciales:</p>
<ul>
<li>Duplicado 1 = 25.56 % Cu</li>
<li>Duplicado 2 = 25.66 % Cu</li>
<li>Diferencia = 0.10 % Cu</li>
</ul>
<p>La diferencia encontrada entre duplicados <span class="math inline">\(\Delta = 0.1 &lt; 0.57\)</span> % Cu, por lo tanto, se acepta la diferencia entre duplicados, es un dato de QAQC conforme.</p>
<p>¿Y qué hacemos si no tenemos datos históricos de duplicados? Por favor, continue leyendo.</p>
</section>
<section id="estimación-mediante-estudios-de-precisión-siguiendo-las-directrices-de-la-guía-iso-5725" class="level1">
<h1>Estimación mediante estudios de precisión siguiendo las directrices de la guía ISO 5725</h1>
<p>Cuando no existen datos históricos, la guía ISO 5725 sugiere llevar a cabo un diseño experimental en el cual se estudien diversos factores que podrían, eventualmente, tener un efecto importante en la precisión del método analítico. Por ejemplo:</p>
<ul>
<li>Analistas distintos</li>
<li>Equipos de medición (cromatógrafos, AAS, etc.)</li>
<li>Días distintos</li>
<li>Etc.</li>
</ul>
<p>El “problema” de esta aproximación es que a medida que crece el número de factores, el tamaño del diseño experimental (a.k.a número de experientos) crece en forma rápida incluso, en algunos diseños, en forma exponencial.</p>
<p>La ventaja de este método es que permite estimar en un único estudio la precisión de repetibilidad, reproducibilidad y la precisión intermedia, es decir, entre-analistas, entre-equipos, etc. La otra ventaja es que permite estimar los denominados componentes de varianza “¿Y?” – se preguntará. Bueno, los componentes de varianza nos indican cuál es el factor que más aporta a la variabilidad del sistema analítico ¿será la variabilidad entre-analistas? ¿o los distintos equipos que dispone el laboratorio? De esta forma Ud. podrá focalizar los esfuerzos y recursos en mejorar la precisión del método sólo en aquellos factores que más aporten a la variabilidad total.</p>
<p>Veamos en qué consiste este método de estimación de precisión en base al estudio del factor <strong>Analista</strong>. Existen varios diseños experimentales para evaluar este factor, sin embargo, en este post comenzaremos con algo <em>light</em>:</p>
<blockquote class="blockquote">
<p>Estimaremos la precisión de reptibilidad y reproducibilidad del método volumétrico para la determinación de Cu en concentrado de cobre, en un laboratorio donde <span class="math inline">\(n = 4\)</span> analistas son igualmente competentes para llevar a cabo el análisis, siguiendo el mismo instructivo.</p>
</blockquote>
<p>Para abordar este objetivo, proponemos el siguiente diseño experimental:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="doe.png" class="img-fluid figure-img" width="700"></p>
<figcaption class="figure-caption">Diseño Experimental</figcaption>
</figure>
</div>
<ol type="1">
<li>Una única muestra será analizada por los <span class="math inline">\(n = 4\)</span> analistas.</li>
<li>Cada analista realizará el análisis en quintuplicado <span class="math inline">\(j = 5\)</span></li>
<li>Los <span class="math inline">\(k = n\cdot j = 20\)</span> análisis deben ser obtenidos en condiciones de repetibilidad</li>
</ol>
<p>Si bien podríamos publicar una enciclopedia de posts sobre diseño experimental en química, surgen algunas preguntas sobre este diseño en particular:</p>
<ul>
<li><p>¿Por qué una única muestra? Porque si cada analista recibiera una muestra distinta, entonces la precisión del factor analista estaría “contaminada” con la variabilidad entre muestras, la cual no nos interesa en este estudio.</p></li>
<li><p>¿Y si una única muestra no es suficiente para llevar a cabo los 20 análisis? Existen otros diseños experimentales denominados <em>anidados</em> que permiten estimar la precisión utilizando muestras distintas.</p></li>
<li><p>¿Por qué los análisis de cada analista deben ser obtenidos en condiciones de repetibilidad? Porque no queremos que otro factor no controlado (por ejemplo, equipos distintos) influya en la estimación de la precisión entre-analistas.</p></li>
<li><p>En lo posible, aumente el número de analistas en vez de hacer muchos replicados. Es mejor 5 analistas en triplicado, que 3 en quintuplicado.</p></li>
<li><p>“La” muestra podría corresponder a una muestra del cliente. No es necesario que sea un material de referencia, sin embargo, esta muestra debe ser lo suficientemente homogénea… ¡Ah, eso es trampa! ¿Cómo demostramos que la muestra es homogénea? Le doy un dato, anote:</p></li>
</ul>
<blockquote class="blockquote">
<p>Si su muestra es material particulado, le tengo malas noticias: No existen las muestras homogéneas de este tipo de material (gracias a san Pierre Gy por el dato).</p>
</blockquote>
<p>Como mencionamos anteriormente podríamos postear <em>ad infinitum</em> sobre diseño de exprimentos en química, sin embargo, la banda ancha es finita así que vamos al grano. La tabla @ref(tab:doe) muestra los datos experimentales del estudio de precisión propuesto:</p>
<div class="cell">
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Resultados de estudio de precisión [% Cu]</caption>
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">Replicado</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Analista 1</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Analista 2</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Analista 3</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Analista 4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">24.74</td>
<td style="text-align: center;">24.73</td>
<td style="text-align: center;">25.06</td>
<td style="text-align: center;">25.00</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">25.06</td>
<td style="text-align: center;">25.16</td>
<td style="text-align: center;">25.17</td>
<td style="text-align: center;">24.98</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">25.34</td>
<td style="text-align: center;">24.98</td>
<td style="text-align: center;">25.24</td>
<td style="text-align: center;">24.79</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">25.28</td>
<td style="text-align: center;">25.11</td>
<td style="text-align: center;">24.80</td>
<td style="text-align: center;">24.65</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">25.02</td>
<td style="text-align: center;">24.72</td>
<td style="text-align: center;">25.11</td>
<td style="text-align: center;">24.82</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Antes de llevar a cabo el análisis estadístico formal, observemos la figura @ref(fig:doeplot) la cual muestra el valor promedio de cada analista <span class="math inline">\(\pm\)</span> 1 desviación estándar. Ella nos indica que, aparentemente, los resultados entre los analistas son bastante consistentes.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/doeplot-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Boxplot estudio de precisión</figcaption>
</figure>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Ahora bien ¿Cómo, entonces, estimamos la precisión de repetibilidad y reproducibilidad a partir de la tabla @ref(tab:doe)? Fácil, con el todopoderoso Análisis de Varianza (ANOVA).</p>
</blockquote>
<p>No detallaremos la matemática detrás de esta poderosa técnica, sin embargo, diremos simplemente que el ANOVA es un método cuyo propósito es particionar la variabilidad total de un conjunto de datos en componentes que intentan explicarla. Aplicada a nuestro caso, utilizaremos ANOVA para particionar la variabilidad total de los 20 resultados de % Cu entre dos componentes:</p>
<ul>
<li>El factor analista</li>
<li>La repetiblidad del método analítico.</li>
</ul>
<p>para lo cual seguiremos paso a paso las instrucciones de la guía ISO 5725. En primer lugar obtendremos la tabla ANOVA mediante lenguaje <code>R</code>:</p>
<div class="cell">
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Tabla ANOVA precisión</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Origen Variación</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">g.l</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">SQ</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">MS</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">F calculado</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">analista</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">0.2</td>
<td style="text-align: center;">0.07</td>
<td style="text-align: center;">1.8</td>
<td style="text-align: center;">0.19</td>
</tr>
<tr class="even">
<td style="text-align: left;">Residuals</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">0.6</td>
<td style="text-align: center;">0.04</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Las tablas ANOVA muy similares en casi todos los softwares estadísticos profesionales… y en Excel también. Entonces:</p>
<ul>
<li><p>Repetibilidad <span class="math inline">\(s_{r}\)</span>: Es simplemente la raíz cuadrada del término <span class="math inline">\(MS\)</span> de los <strong>Residuos</strong>. En la nomenclatura de ANOVA es lo que se conoce como variabilidad dentro (<em>within</em>). Para los datos de la tabla @ref(tab:doe) se obtiene <span class="math inline">\(s_{r} = \sqrt{\text{MS}_{Residuals}} = \sqrt{0.04} = 0.19\)</span> % Cu.</p></li>
<li><p>Precisión intermedia o variabilidad entre-analistas <span class="math inline">\(s_{analista}\)</span>: ¡No tan rápido! No es la raíz cuadrada de <span class="math inline">\(MS\)</span> del factor analista. Debemos hacer el siguiente cálculo adicional:</p></li>
</ul>
<p><span class="math display">\[\begin{eqnarray}
  s_{analista} &amp;=&amp; \sqrt{\frac{MS_{analista} - MS_{Residuals}}{j}} \\
  s_{analista} &amp;=&amp; \sqrt{\frac{0.07 - 0.04}{5}} \\
  s_{analista} &amp;=&amp; 0.08\, \text{% Cu}
\end{eqnarray}\]</span></p>
<p>donde <span class="math inline">\(j = 5\)</span> es el número de replicados que hizo cada analista</p>
<ul>
<li>Reproducibilidad <span class="math inline">\(s_{R}\)</span>: Es simplemente la combinación en cuadratura de las precisiones arriba calculadas.</li>
</ul>
<p><span class="math display">\[\begin{eqnarray}
  s_{R} &amp;=&amp; \sqrt{s_{r}^{2} + s_{analista}^2}\\
  s_{R} &amp;=&amp; 0.21\, \text{% Cu}
\end{eqnarray}\]</span></p>
<p>Por lo tanto, con estos datos podemos calcular el límite de repetibilidad sin necesidad de tener una base de datos histórica de duplicados. En este caso <span class="math inline">\(r = 2.8 s_{r} = 0.58\)</span> % Cu.</p>
<blockquote class="blockquote">
<p>¿Y si quisiera establecer la máxima diferencia tolerable entre analistas?</p>
</blockquote>
<p>Nos vemos en el siguiente post.</p>
</section>
<section id="bonus-track-breve-historia-del-factor-2.8" class="level1">
<h1><em>Bonus track</em> : Breve historia del factor 2.8</h1>
<p>Sea <span class="math inline">\(x_{1}\)</span> y <span class="math inline">\(x_{2}\)</span> los duplicados de análisis 1 y 2, respectivamente. Cada uno de ellos “sigue” una distribución Normal con media <span class="math inline">\(\mu\)</span> y varianza <span class="math inline">\(V = \sigma_{r}^2\)</span> y, además, entre ellos son <em>independientes</em>, entonces se cumple lo siguiente:</p>
<ol type="1">
<li><p>la diferencia entre duplicados <span class="math inline">\(\Delta = x_{1} - x_{2}\)</span> sigue una distribución Normal con media 0 y varianza <span class="math inline">\(V_{\Delta} = V(x_{1} - x_{2}) = V(x_{1}) + V(x_{2}) = 2\sigma_{r}^2\)</span>.</p></li>
<li><p>Si la varianza de las diferencias es <span class="math inline">\(V_{\Delta} = 2\sigma_{r}^2\)</span>, entonces la desviación estándar es <span class="math inline">\(\sqrt{2} \sigma_{r}\)</span>.</p></li>
<li><p>Por lo tanto, si quisiéramos construir un intervalo de confianza al 95% para la diferencia entre duplicados obtendríamos <span class="math inline">\(\Delta \pm 2\sqrt{2} \sigma_{r}\)</span>. El 2 es por que para una distribución Normal se sabe que entre la media <span class="math inline">\(\pm\)</span> 2 la desviación estándar se encuentran aproximadamente el 95% de las observaciones.</p></li>
<li><p><span class="math inline">\(s_{r}\)</span> es la estimación de <span class="math inline">\(\sigma_{r}\)</span>, la cual es fija pero desconocida.</p></li>
<li><p>Como <span class="math inline">\(\sqrt{2}\approx 1,41\)</span> entonces, con un 95% de confianza, la diferencia se encuentra entre <span class="math inline">\(\Delta \pm 2\cdot 1,41 \cdot s_{r} = 2.8\cdot s_{r}\)</span>. Ahora imágineme como el mago Tamariz al final de sus actos tocando el violín ¡chiararaaá! (Si eres <em>old school</em> sabrás quien es el mago Tamariz. Si eres <em>millenial</em> mira este <a href="https://www.youtube.com/watch?v=zcSqG2v-MZQ">video</a>).</p></li>
</ol>
</section>
<section id="bibliografía" class="level1">
<h1>Bibliografía</h1>
<ol type="1">
<li><p>ISO 5725 – 3:1994 Accuracy (trueness and precision) of measurement methods and results – Part 3: Intermediate measures of the precision of a standard measurement method</p></li>
<li><p>Michael Thompson, Bertil Magnusson Methodology in internal quality control of chemical analysis <em>Accreditation and Quality Assurance August 2013, Volume 18, Issue 4, pp 271–278</em></p></li>
</ol>


</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Copyright 2024, Carlos Gómez</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/analytical/website_analytical">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/cjgomezs/">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>



</body></html>