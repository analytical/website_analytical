{
  "hash": "1f74514531bbcd97a0affd894ad2c760",
  "result": {
    "markdown": "---\ntitle: ¿Cuántos laboratorios de ensayo acreditados por el INN hay en Chile? Versión 2023\ndate: '2023-07-03'\nsummary: 'Este post muestra el **paso a paso** del análisis estadístico en R, sobre los laboratorios de ensayos acreditados hasta julio de 2023'\nlastmod: '2023-07-03T11:16:37-04:00'\n\n---\n\n\n\n\nHace ya casi 2 años publiqué un [post](https://www.linkedin.com/posts/cjgomezs_acreditados-activity-6856380114675011584-7hnO?utm_source=share&utm_medium=member_desktop) acerca de cuántos laboratorios de ensayos acreditados existían en Chile el 2021. La publicación generó airadas reacciones, sin embargo, se abrió un interesante debate (esa es la idea).\n\nEs tiempo de actualizar ese análisis con los datos de 2023. En esta oportunidad llevaremos a cabo el \nanálisis paso a paso en `R` bajo el concepto de [*Reproducible Research*](https://esajournals.onlinelibrary.wiley.com/doi/10.1002/bes2.1801)\n\n**Nota: Considerar que algunas razones sociales podrían tener varios laboratorios/alcances\nacreditados, por lo tanto, este gráfico en realidad cuenta el número de acreditaciones.\n(¿Clickbait?)**\n\nLa versión de este post es *semi-automática*, es decir, algunas operaciones serán \nhechas *a mano*. Podríamos aplicar *web scraping* y bajar los datos directamente desde la página web del INN, pero eso qudará para otro post (lo intuye bien querid@ lector@... cuando yo aprenda a hacerlo.)\n\n## ¿Dónde están los datos de laboratorios acreditados por el INN?\n\nBueno, lo primero es dirigirnos al siguiente link para bajar los datos desde la\npágina del INN (son datos públicos por si acaso):\n\n[Directorio de Acreditados](https://acreditacion.innonline.cl/)\n\n![](acreditados.png)\n\nEn el campo *Tipo de ESquema de Acreditación* seleccionamos *Laboratorios de ensayo*:\n\n\n![](acreditados2.png)\n\nPresionamos *Buscar* y obtenderemos el listado completo (incluyendo los laboratorios suspendidos):\n\n![](acreditados3.png)\n\nLamentablemente, el sitio no tiene ninguna opción para bajar los datos en Excel u\notro formato, así que tendremos que hacerlo a la antigua:\n\n1. Botón derecho y se abrirá el siguiente menú:\n\n![](acreditados4.png)\n\n\n2. Elija *Guardar Como* y en tipo seleccione *Página web (completa)* y guárdelo\ncon el nombre *acreditados.html* (el nombre da igual)\n\n![](acreditados5.png)\n\nListo, hemos bajado los datos y ahora debemos *limpiarlos* ya que incluso se \ndescargaron los íconos de los certificado en pdf. Tenemos que dejar la tabla \nlimpia para el análisis en `R` (o para cualquier otro software)\n\n## Limpieza de la base de datos en Excel\n\nHaremos la limpieza de datos en Excel. \n\n1. Abra Excel \n2. Ahora abra el archivo archivados.html que guardó (sí, Excel puede abrir este tipo de archivos) y obtendrá algo similar a esto:\n\n![](acreditados6.png)\n\nEl objetivo es llegar a una hoja de Excel plana:\n\n![](acreditados7.png)\n\n3. Seleccionemos todos los datos inlcuyendo los encabezados de las columnas \n(N, N Certi, etc), copiar y pegar en una **nueva hoja** sólo como datos, es decir,\nnos ubicamos en la celda A1 de la hoja nueva, presionamos botón derecho y seleccionamos\n`Valores (V)`:\n\n![](index.es_insertimage_2.png)\n\nY obtendremos lo siguiente:\n\n![](index.es_insertimage_3.png)\n\n4. Eliminamos la columna B:\n\n![](index.es_insertimage_4.png)\n\n5. Hemos obtenido la tabla que buscábamos:\n\n![](index.es_insertimage_5.png)\n\n6. Lo único que nos falta es modificar un poco los encabezados para eliminar\nacentos, espacios en blanco, etc. Para que Ud. pueda reproducir este análisis\ncambie los encabezados por los siguientes:\n\n![](index.es_insertimage_6.png)\n\n7. ¡Listo! hemos *limpiado* la base de datos, la cual debe lucir más o menos así \nen el Excel:\n\n![](index.es_insertimage_7.png)\n\n8. Cambiemos el nombre la hoja a `datos`:\n\n![](index.es_insertimage_8.png)\n\n9. Por último guardar el libro Excel con el nombre `acreditados.xlsx`\n\n\n## Análisis estadístico en `R`\n\nAbrimos el software RStudio y generamos un nuevo script:\n\n![](index.es_insertimage_9.png)\n\nGuardamos el script con el nombre `acreditados.R` en el **mismo directorio**\nque guardamos la base de datos limpia `acreditados.xlsx`\n\nLos siguientes comandos importan la base de datos del INN desde el Excel hasta `R`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\nacreditados <- read_excel('acreditados.xlsx', sheet = 'datos')\n```\n:::\n\n\nLa importación ha sido exitosa si observa la siguiente tabla con el comando `head()`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(acreditados)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 7\n      N N_certificado Organización      Tipo_de_OEC Area  Observaciones Telefono\n  <dbl> <chr>         <chr>             <chr>       <chr> <chr>         <chr>   \n1     1 LE 633        Universidad Aust… Laboratori… Bioe… <NA>          (56 65)…\n2     2 LE 800        Universidad de C… Laboratori… Bioe… <NA>          (56) 22…\n3     3 LE 893        Universidad de C… Laboratori… Bioe… <NA>          (56 65)…\n4     4 LE 1287       Secretaria Regio… Laboratori… Bioe… <NA>          (56 61)…\n5     5 LE 1450       TAAG Genetics S.… Laboratori… Biol… <NA>          (56) 22…\n6     6 LE 1279       Universidad de L… Laboratori… Bioq… <NA>          (56 64)…\n```\n:::\n:::\n\n\nAhora haremos el gráfico de barras el cual indica el número de laboratorios de \nensayo acreditados por el INN al 03 de julio de 2023 clasificados por `Area`.\nPor una cuestión de espacios sólo se muestran aquellas áreas con más de 10 laboratorios acreditados:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(ggplot2)\nlibrary(magrittr)\n\nacreditados <- read_excel('acreditados.xlsx', sheet = 'datos')\n\ntabla <- acreditados %>% \n  group_by(Area) %>% \n  summarise(n = n())\n\n# Número de acreditaciones suspendidas\nn.suspendidos <- acreditados %>% \n  filter(!is.na(Observaciones)) %>% \n  count()\n\n# Número de acreditaciones totales (incluyendo las suspendidas)\nn.total <- acreditados %>% \n  count()\n\n\nggplot(tabla %>% filter(n >= 10), aes(x = reorder(Area, n), y = n, label = n)) +\n  geom_bar(stat = \"identity\", fill = 'blue', alpha = 0.7) +\n  ylab('N° de laboratorios de ensayo') +\n  xlab('Área') +\n  labs(title = paste('Acreditaciones en Chile por INN bajo ISO 17025 por área N =', \n                     n.total),\n       subtitle = paste(\"Incluye \", n.suspendidos, \"suspendidos. Sólo se muestran n > 10\"),\n       caption = \"Fuente: https://acreditacion.innonline.cl/\") +\n  theme_bw() +\n  geom_text(size=5,hjust=1.5, col = 'white') +\n  coord_flip()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=1152}\n:::\n:::\n\n\n\n¡Listo!\nEn un siguiente paso podríamos desagregar por *Organización*, de tal manera de \natribuir las acreditaciones clasificando por razón social ¿Le parece estimad@ lector@?\n\nSaludos\n\n\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}